!function(a){"use strict";function b(a,b){this.config=null,this.container=null,this.controls={},this.loaded=!1,this.animation=!1,this.init(a,b)}var c=function(){function a(){}return a.prototype.isMobile=function(a){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(a)},a.prototype.animationEvent=function(){var a=document.createElement("fakeelement"),b={animation:"animationend",MSAnimationEnd:"msAnimationEnd",OAnimation:"oAnimationEnd",MozAnimation:"mozAnimationEnd",WebkitAnimation:"webkitAnimationEnd"};for(var c in b)if(void 0!==a.style[c])return b[c]},a}(),d="slidemenu",e="slidemenu-instance";b.prototype={defaults:{theme:null,menuWidth:"18em",menuHeight:"24em",responsive:!0,responsiveWidth:768,moveDuration:200,moveEasing:null,moveOffset:.2,closeInterval:100,slidesCenter:!0,showClass:null,hideClass:null,zindex:9999,resetBeforeClose:!0,slideClose:!0,easyClose:!0,mobile:!1},init:function(a,b){this.destroy(),this.container=a,this.config=b,this.create()},create:function(){this.checkAnimation(),this.applyDOM(),this.applyHandlers(),this.loaded=!0},destroy:function(){this.loaded&&(this.resetHandlers(),this.resetDOM())},checkAnimation:function(){var a=!this.config.mobile&&this.util().isMobile(navigator.userAgent);(void 0==this.util().animationEvent()||a)&&(this.config.showClass=null,this.config.hideClass=null)},applyDOM:function(){this.container.addClass("slm-menu"),this.container.find("li").each(function(){a(this).addClass("slm-item")}),this.container.find("li > ul").each(function(){a(this).addClass("slm-submenu")}),this.container.find(".slm-item > .slm-submenu").each(function(){a(this).closest(".slm-item").addClass("slm-item-has-children")}),this.container.wrap("<div class='slm-wrap "+(this.config.theme?" "+this.config.theme:"")+"'></div>"),this.controls.wrap=this.container.parent(".slm-wrap"),this.controls.wrap.css({"z-index":this.config.zindex}),this.container.wrap("<div class='slm-anchor'></div>"),this.controls.anchor=this.container.parent(".slm-anchor"),this.applyAnchorStyle(),this.container.wrap("<div class='slm-slide'></div>");var b=this.container.parent(".slm-slide");this.config.slideClose&&b.prepend("<div class='slm-close'></div>"),this.container.wrap("<div class='slm-data'></div>"),this.container.find(".slm-submenu").each(a.proxy(function(b,c){var e=a("<div class='slm-slide'></div>"),f=a(c),g=f.parent(".slm-item");e.data(d,{owner:g}),g.data(d,{slide:e}),f.detach(),this.config.slideClose&&e.append("<div class='slm-close'></div>"),e.append(a("<div class='slm-data'></div>").append(f)),this.controls.anchor.append(e)},this))},applyAnchorStyle:function(){this.controls.anchor.css({top:"50%",left:"50%",width:this.config.menuWidth,height:this.config.menuHeight});var a=this.controls.anchor.width(),b=this.controls.anchor.height();this.controls.anchor.css({"margin-top":-b/2+"px","margin-left":-a/2+"px"})},resetAnchorStyle:function(){this.controls.anchor.css({top:"0",left:"0",width:"100%",height:"100%",margin:"0"})},resetDOM:function(){this.controls.wrap.find(".slm-slide").each(a.proxy(function(b,c){var e=a(c),f=e.find(".slm-data"),g=f.children(),h=e.data(d);h&&h.owner&&(g.detach(),h.owner.append(g),e.remove())},this));var b=this.controls.wrap.find(".slm-slide").first();b.find(".slm-close").remove(),this.container.unwrap().unwrap().unwrap().unwrap(),this.container.removeClass("slm-menu"),this.container.find("li").each(function(){a(this).removeClass("slm-item").removeClass("slm-item-has-children")}),this.container.find("li > ul").each(function(){a(this).removeClass("slm-submenu")})},applyHandlers:function(){this.controls.wrap.find(".slm-slide").on("click.slidemenu touchstart.slidemenu",a.proxy(this.onSlideClick,this)),this.controls.wrap.find(".slm-slide .slm-close").on("click.slidemenu touchstart.slidemenu",a.proxy(this.onSlideClose,this)),this.controls.wrap.find(".slm-item > a").on("click.slidemenu touchstart.slidemenu",a.proxy(this.onItemClick,this)),this.controls.wrap.on("click.slidemenu touchstart.slidemenu",a.proxy(this.onWrapClick,this)),a(window).on("resize.slidemenu",a.proxy(this.onResize,this)),a(window).on("load.slidemenu",a.proxy(this.onLoad,this))},resetHandlers:function(){this.controls.wrap.find(".slm-slide").off("click.slidemenu"),this.controls.wrap.find(".slm-slide .slm-close").off("click.slidemenu"),this.controls.wrap.find(".slm-item > a").off("click.slidemenu"),this.controls.wrap.off("click.slidemenu"),a(window).off("resize.slidemenu"),a(window).off("load.slidemenu")},updateLayout:function(){this.config.responsive&&(a(window).width()<this.config.responsiveWidth?this.applyResponsive():this.resetResponsive())},applyResponsive:function(){this.controls.wrap.hasClass("slm-responsive")||(this.controls.wrap.addClass("slm-responsive"),this.resetAnchorStyle())},resetResponsive:function(){if(this.controls.wrap.hasClass("slm-responsive")){this.controls.wrap.removeClass("slm-responsive"),this.applyAnchorStyle();var a=this.controls.wrap.find(".slm-slide.slm-active").first();a.length>0&&this.animateSlides(a,null,!1)}},animateSlides:function(a,b,c){if(!this.animation){this.animation=!0;var d=a.prevAll(".slm-active").length+(b?1:0),e=this.controls.wrap.find(".slm-slide.slm-active").length,f=a.outerWidth(),g=Math.floor(((e-d)*f-f)*this.config.moveOffset);this.config.slidesCenter&&(g=Math.floor(.5*g));var h={self:this,slide_count_before_and_with_current:d,slide_count:e,offset:g,$slide_current:a,$slide_new:b,closeAfterDone:c};b?this.removeSlides(h).then(this.moveSlides).then(this.addSlide).done(this.animateSlidesDone):this.removeSlides(h).then(this.moveSlides).done(this.animateSlidesDone)}},removeSlides:function(b){var c=a.Deferred(),d=function(c,d){var e=a.Deferred();return setTimeout(function(){c.removeClass(b.self.config.showClass),c.addClass(b.self.config.hideClass),b.self.config.hideClass?c.one(b.self.util().animationEvent(),a.proxy(function(b){var c=a(b.target);c.hasClass(this.config.showClass)||(c.removeClass("slm-active"),c.removeClass(this.config.hideClass),e.resolve())},b.self)):(c.removeClass("slm-active"),e.resolve())},d),e.promise()},e=function(){c.resolve(b)},f=[];if(b.$slide_current.nextAll(".slm-active").each(function(c,e){var g=a(this),h=(b.slide_count-c)*b.self.config.closeInterval;f.push(d(g,h))}),b.self.config.resetBeforeClose&&b.closeAfterDone){var g=(b.slide_count+1)*b.self.config.closeInterval;f.push(d(b.$slide_current,g))}return a.when.apply(a,f).done(e),c.promise()},moveSlides:function(b){var c=a.Deferred(),d=function(c){var d=a.Deferred(),e=c.position(),f=function(){d.resolve()};return c.animate({left:0==b.slide_count_before_and_with_current?0:e.left+b.offset},{duration:b.self.config.moveDuration,easing:b.self.config.moveEasing,complete:f}),d.promise()},e=function(){c.resolve(b)},f=[];return b.$slide_current.prevAll(".slm-active").andSelf().each(function(b,c){var e=a(this);f.push(d(e))}),a.when.apply(a,f).done(e),c.promise()},addSlide:function(b){var c=a.Deferred(),d=b.$slide_current.position(),e=b.$slide_current.outerWidth()*b.self.config.moveOffset;return b.$slide_new.css({left:d.left+e}),b.$slide_new.addClass("slm-active"),b.$slide_new.removeClass(b.self.config.hideClass),b.$slide_new.addClass(b.self.config.showClass),c.resolve(b),c.promise()},animateSlidesDone:function(a){a.self.animation=!1,a.self.config.resetBeforeClose&&a.closeAfterDone&&a.self.toggleMenuActions()},toggleMenu:function(){if(this.config.resetBeforeClose&&this.controls.wrap.hasClass("slm-active")){var a=this.controls.wrap.find(".slm-slide.slm-active").first();return void(a.length>0&&this.animateSlides(a,null,!0))}this.toggleMenuActions()},toggleMenuActions:function(){this.controls.wrap.toggleClass("slm-active");var a=this.controls.wrap.find(".slm-slide").first();0!=a.length&&(this.controls.wrap.hasClass("slm-active")?(a.addClass("slm-active"),this.controls.wrap.find(".slm-slide.slm-active").removeClass(this.config.hideClass).addClass(this.config.showClass)):(this.controls.wrap.find(".slm-slide.slm-active").removeClass(this.config.hideClass).removeClass(this.config.showClass),(this.config.resetBeforeClose||1==this.controls.wrap.find(".slm-slide.slm-active").length)&&a.find(".slm-item.slm-active").removeClass("slm-active"),a.removeClass("slm-active")))},onSlideClick:function(a){a.stopPropagation()},onSlideClose:function(b){var c=a(b.target),d=c.closest(".slm-slide"),e=d.prevAll(".slm-slide.slm-active").first();return 0==e.length?void this.toggleMenu():(d.nextAll().andSelf().find(".slm-item.slm-active").removeClass("slm-active"),void this.animateSlides(e))},onItemClick:function(b){var c=a(b.target),e=c.closest(".slm-item"),f=e.closest(".slm-slide");if(e.hasClass("slm-item-has-children")){b.preventDefault();var g=e.data(d);g&&g.slide&&!this.animation&&(f.nextAll().andSelf().find(".slm-item.slm-active").removeClass("slm-active"),e.addClass("slm-active"),this.animateSlides(f,g.slide))}},onWrapClick:function(a){this.config.easyClose&&this.toggleMenu()},onResize:function(a){this.updateLayout()},onLoad:function(a){this.updateLayout()},util:function(){return null!=this._util?this._util:this._util=new c}},a.fn.slidemenu=function(c,d){return this.each(function(){var d=a(this),f=d.data(e),g=a.isPlainObject(c)?c:{};if("destroy"==c){if(!f)throw Error("Calling 'destroy' method on not initialized instance is forbidden");return d.removeData(e),void f.destroy()}if("toggle"==c){if(!f)throw Error("Calling 'toggle' method on not initialized instance is forbidden");return void f.toggleMenu()}if(f){var h=a.extend({},f.config,g);f.init(d,h)}else{var h=a.extend({},b.prototype.defaults,g);f=new b(d,h),d.data(e,f)}})}}(window.jQuery);